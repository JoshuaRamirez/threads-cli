rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Tenant-scoped data: only accessible by authenticated users with matching tenantId claim
    match /tenants/{tenantId}/{document=**} {
      allow read, write: if request.auth != null
        && request.auth.token.tenantId == tenantId;
    }

    // API keys collection (for ChatGPT Actions auth)
    // Only readable by the system (Cloud Functions with admin SDK)
    match /apiKeys/{keyId} {
      allow read, write: if false; // Admin SDK bypasses rules
    }
  }
}
